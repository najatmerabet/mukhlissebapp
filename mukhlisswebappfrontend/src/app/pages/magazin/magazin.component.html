<div class="admin-container">
  <!-- Barre d'actions améliorée -->
  <div class="actions-bar modern-card">
    <div class="search-section">
      <div class="search-input-container">
        <i class="fas fa-search search-icon"></i>
        <input
          type="text"
          class="modern-search-input"
          placeholder="Rechercher par nom, ville..."
          [(ngModel)]="searchQuery"
          (input)="filterMagazins()" />
      </div>
      
      <select
        class="modern-filter-select"
        [(ngModel)]="selectedCategory"
        (change)="filterMagazins()">
        <option value="">Toutes les catégories</option>
        <option *ngFor="let category of categories" [value]="category.id">
          {{ category.name }}
        </option>
      </select>
    </div>

    <div class="actions-section">
      <button class="modern-btn primary" (click)="addStore()">
        <i class="fas fa-plus"></i> Nouveau Magasin
      </button>
     
    </div>
  </div>

  <!-- Messages -->
  <div *ngIf="isLoading" class="modern-loading-message">
    <i class="fas fa-circle-notch fa-spin"></i> Chargement des magasins en cours...
  </div>
  <div *ngIf="errorMessage" class="modern-error-message">
    <i class="fas fa-exclamation-triangle"></i> {{ errorMessage }}
  </div>

  <!-- Tableau modernisé -->
  <div *ngIf="!isLoading && !errorMessage" class="modern-stores-wrapper">
    <div class="modern-table-header">
      <h2 class="modern-table-title">
        <i class="fas fa-store"></i> Liste des Magasins
        <span class="modern-badge">{{ filteredMagazins.length }}</span>
      </h2>
      <div class="modern-table-actions">
        <div class="modern-pagination-info">
          {{ (currentPage - 1) * itemsPerPage + 1 }}-{{ math.min(currentPage * itemsPerPage, filteredMagazins.length) }} sur {{ filteredMagazins.length }}
        </div>
      </div>
    </div>

    <div class="modern-table-container">
      <table class="modern-stores-table">
        <thead>
          <tr>
            <th class="store-col">Magasin</th>
            <th class="address-col">Adresse</th>
            <th class="contact-col">Contact</th>
            <th class="category-col">Catégorie</th>
            <th class="actions-col">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let magazin of getPaginatedItems()" class="modern-table-row">
            <td>
              <div class="modern-store-info">
                <div class="modern-store-logo">
                  <ng-container *ngIf="magazin.logoUrl; else defaultIcon">
                    <img [src]="magazin.logoUrl" [alt]="magazin.name" class="modern-logo-img" />
                  </ng-container>
                  <ng-template #defaultIcon>
                    <div class="modern-store-icon">
                      <i class="fas fa-store"></i>
                    </div>
                  </ng-template>
                </div>
                <div class="modern-store-details">
                  <h4>{{ magazin.name }}</h4>
                  
                </div>
              </div>
            </td>
            <td>
              <div class="modern-contact-info">
                <div class="modern-address">
                  <i class="fas fa-map-marker-alt"></i>
                  <span>{{ magazin.address || 'Non renseignée' }}</span>
                </div>
                <div class="modern-city">
                  {{ magazin.city }}, {{ magazin.postal_code }}
                </div>
              </div>
            </td>
            <td>
              <div class="modern-contact-info">
                <div class="modern-phone" *ngIf="magazin.phone">
                  <i class="fas fa-phone"></i> {{ magazin.phone }}
                </div>
                <div class="modern-email">
                  <i class="fas fa-envelope"></i> {{ magazin.email || 'Non renseigné' }}
                </div>
              </div>
            </td>
            <td>
              <span class="modern-category-label" [style.backgroundColor]="getCategoryColor(magazin.category?.id)">
                {{ magazin.category?.name || 'Non renseignée' }}
              </span>
            </td>
            <td>
              <div class="modern-row-actions">
                <button class="modern-action-btn view" title="Voir détails" (click)="viewDetails(magazin.id)">
                  <i class="fas fa-eye"></i>
                </button>
                <button class="modern-action-btn edit" title="Modifier" (click)="editMagazin(magazin.id)">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="modern-action-btn delete" title="Supprimer" (click)="deleteMagazin(magazin.id)">
                  <i class="fas fa-trash-alt"></i>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination modernisée -->
    <div class="modern-pagination-container">
      <div class="modern-items-per-page">
        <label>Afficher :</label>
        <select [(ngModel)]="itemsPerPage" (change)="onItemsPerPageChange()" class="modern-select">
          <option value="5">5</option>
          <option value="10">10</option>
          <option value="20">20</option>
          <option value="50">50</option>
        </select>
      </div>
      
      <div class="modern-pagination-controls">
        <button class="modern-pagination-btn first" 
                (click)="goToPage(1)" 
                [disabled]="currentPage === 1">
          <i class="fas fa-angle-double-left"></i>
        </button>
        <button class="modern-pagination-btn prev" 
                (click)="prevPage()" 
                [disabled]="currentPage === 1">
          <i class="fas fa-angle-left"></i>
        </button>

        <div class="modern-pagination-pages">
          <ng-container *ngIf="totalPages <= 7">
            <button *ngFor="let page of getPageNumbers()"
                    class="modern-pagination-page"
                    [class.active]="currentPage === page"
                    (click)="goToPage(page)">
              {{ page }}
            </button>
          </ng-container>

          <ng-container *ngIf="totalPages > 7">
            <button *ngFor="let page of getVisiblePages().startPages"
                    class="modern-pagination-page"
                    [class.active]="currentPage === page"
                    (click)="goToPage(page)">
              {{ page }}
            </button>

            <div *ngIf="shouldShowStartEllipsis()" class="modern-pagination-ellipsis">...</div>

            <button *ngFor="let page of getVisiblePages().middlePages"
                    class="modern-pagination-page"
                    [class.active]="currentPage === page"
                    (click)="goToPage(page)">
              {{ page }}
            </button>

            <div *ngIf="shouldShowEndEllipsis()" class="modern-pagination-ellipsis">...</div>

            <button *ngFor="let page of getVisiblePages().endPages"
                    class="modern-pagination-page"
                    [class.active]="currentPage === page"
                    (click)="goToPage(page)">
              {{ page }}
            </button>
          </ng-container>
        </div>

        <button class="modern-pagination-btn next" 
                (click)="nextPage()" 
                [disabled]="currentPage === totalPages">
          <i class="fas fa-angle-right"></i>
        </button>
        <button class="modern-pagination-btn last" 
                (click)="goToPage(totalPages)" 
                [disabled]="currentPage === totalPages">
          <i class="fas fa-angle-double-right"></i>
        </button>
      </div>
    </div>
  </div>
</div>