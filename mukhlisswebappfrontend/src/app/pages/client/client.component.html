<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liste des Clients - Interface Améliorée</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>
    <div class="admin-container">
        <!-- Barre d'actions améliorée -->
        <div class="actions-bar modern-card">
            <!-- <div class="search-section">
                <div class="search-input-container">
                    <input
                        type="text"
                        class="modern-search-input"
                        placeholder="Rechercher un client par nom, prénom, email ou téléphone..."
                        [(ngModel)]="searchTerm"
                        (input)="filterClients()" />
                    <span class="material-icons search-icon">search</span>
                </div>
            </div> -->

            <div class="actions-section">
                <button class="modern-btn primary" (click)="exportToCSV()" [disabled]="!clients || clients.length === 0">
                    <i class="fas fa-download"></i>
                    Exporter CSV
                </button>
            </div>
        </div>

        <!-- Tableau modernisé -->
        <div *ngIf="!isLoading" class="modern-stores-wrapper">
            <div class="modern-table-header">
                <h2 class="modern-table-title">
                    <i class="fas fa-users"></i> Liste des Clients
                    <span class="modern-badge">{{ filteredClients.length || 0 }}</span>
                </h2>
                <div class="modern-table-actions">
                    <div class="modern-pagination-info">
                      {{ (currentPage - 1) * itemsPerPage + 1 }}-{{ Math.min(currentPage * itemsPerPage, filteredClients.length) }} sur {{ filteredClients.length }}
                    </div>
                </div>
            </div>

            <!-- État vide -->
            <div *ngIf="!clients || clients.length === 0" class="empty-state modern-card">
                <i class="fas fa-users" style="font-size: 4rem; color: #6c757d; margin-bottom: 1rem;"></i>
                <h3>Aucun client trouvé</h3>
                <p>Il n'y a actuellement aucun client dans votre base de données.</p>
            </div>

            <!-- Tableau des clients -->
            <div *ngIf="clients && clients.length > 0" class="modern-table-container">
                <table class="modern-stores-table">
                    <thead>
                        <tr>
                            <th class="index-col">#</th>
                            <th class="name-col">Prénom</th>
                            <th class="name-col">Nom</th>
                            <th class="email-col">Email</th>
                            <th class="phone-col">Téléphone</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let client of paginatedClients; let i = index" class="modern-table-row">
                            <td>
                                <div class="client-index">
                                    <span class="index-badge">{{ (currentPage - 1) * itemsPerPage + i + 1 }}</span>
                                </div>
                            </td>
                            <td>
                                <div class="modern-contact-info">
                                    <div class="client-avatar">
                                        {{ (client.prenom?.charAt(0) || '?').toUpperCase() }}
                                    </div>
                                    <span>{{ client.prenom || 'Non renseigné' }}</span>
                                </div>
                            </td>
                            <td>
                                <div class="modern-contact-info">
                                    <span>{{ client.nom || 'Non renseigné' }}</span>
                                </div>
                            </td>
                            <td>
                                <div class="modern-contact-info">
                                    <a *ngIf="client.email" [href]="'mailto:' + client.email" class="email-link">
                                        <i class="fas fa-envelope"></i>
                                        {{ client.email }}
                                    </a>
                                    <span *ngIf="!client.email" class="no-data">Non renseigné</span>
                                </div>
                            </td>
                            <td>
                                <div class="modern-contact-info">
                                    <a *ngIf="client.telephone" [href]="'tel:' + client.telephone" class="phone-link">
                                        <i class="fas fa-phone"></i>
                                        {{ client.telephone }}
                                    </a>
                                    <span *ngIf="!client.telephone" class="no-data">Non renseigné</span>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Pagination modernisée -->
            <div *ngIf="clients && clients.length > 0" class="modern-pagination-container">
                <div class="modern-items-per-page">
                    <label>Afficher :</label>
                    <select [(ngModel)]="itemsPerPage" (change)="changeItemsPerPage($event)" class="modern-select">
                        <option value="5">5</option>
                        <option value="10">10</option>
                        <option value="20">20</option>
                        <option value="50">50</option>
                    </select>
                </div>
                
                <div class="modern-pagination-controls">
                    <button class="modern-pagination-btn first" 
                            (click)="goToPage(1)" 
                            [disabled]="currentPage === 1">
                        <i class="fas fa-angle-double-left"></i>
                    </button>
                    <button class="modern-pagination-btn prev" 
                            (click)="previousPage()" 
                            [disabled]="currentPage === 1">
                        <i class="fas fa-angle-left"></i>
                    </button>

                    <div class="modern-pagination-pages">
                        <ng-container *ngIf="totalPages <= 7">
                            <button *ngFor="let page of getPageNumbers()" 
                                    class="modern-pagination-page"
                                    [class.active]="currentPage === page"
                                    (click)="handlePageClick(page)">
                                {{ page }}
                            </button>
                        </ng-container>

                        <ng-container *ngIf="totalPages > 7">
                           <button *ngFor="let page of getVisiblePages().startPages"
        class="modern-pagination-page"
        [class.active]="currentPage === page"
        (click)="handlePageClick(page)">  <!-- ← Changer goToPage par handlePageClick -->
    {{ page }}
</button>

                            <div *ngIf="shouldShowStartEllipsis()" class="modern-pagination-ellipsis">...</div>

                            <button *ngFor="let page of getVisiblePages().middlePages"
                                    class="modern-pagination-page"
                                    [class.active]="currentPage === page"
                                    (click)="goToPage(page)">
                                {{ page }}
                            </button>

                            <div *ngIf="shouldShowEndEllipsis()" class="modern-pagination-ellipsis">...</div>

                            <button *ngFor="let page of getVisiblePages().endPages"
                                    class="modern-pagination-page"
                                    [class.active]="currentPage === page"
                                    (click)="goToPage(page)">
                                {{ page }}
                            </button>
                        </ng-container>
                    </div>

                    <button class="modern-pagination-btn next" 
                            (click)="nextPage()" 
                            [disabled]="currentPage === totalPages">
                        <i class="fas fa-angle-right"></i>
                    </button>
                    <button class="modern-pagination-btn last" 
                            (click)="goToPage(totalPages)" 
                            [disabled]="currentPage === totalPages">
                        <i class="fas fa-angle-double-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</body>
</html>